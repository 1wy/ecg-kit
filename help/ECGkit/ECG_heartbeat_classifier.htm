<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta charset="utf-8" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="chunktype" content="refpage" />
<meta name="refentity" itemprop="refentity" content="function:ECGwrapper" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="toctype" itemprop="pagetype" content="fcn" />
<meta name="infotype" itemprop="infotype" content="ref/function" />
<meta name="description" itemprop="description" content="This MATLAB function generates a view of a MATLAB file in HTML format for sharing your code." />
<meta name="generator" content="Adobe RoboHelp 11" />
<title>ECG_heartbeat_classifier</title>
<link rel="StyleSheet" href="merged.css" type="text/css" />
<script type="text/javascript" src="includes/product/scripts/jquery/jquery-latest.js"></script>
<script type="text/javascript" src="includes/shared/scripts/l10n.js"></script>
<script type="text/javascript" src="includes/shared/scripts/docscripts.js"></script>
<script type="text/javascript" src="includes/product/scripts/docscripts.js"></script>
<script type="text/javascript" src="includes/shared/scripts/mw.toc.js"></script>
<script type="text/javascript" src="includes/shared/scripts/mw.imagescaling.js"></script>
<script type="text/javascript" src="includes/shared/scripts/mw.imageanimation.js"></script>
<script type="text/javascript" src="includes/shared/scripts/mw.breadcrumb.js"></script>
<script type="text/javascript" src="includes/shared/scripts/jquery.highlight.js"></script>
<script type="text/javascript" src="includes/shared/scripts/nanoscroller.min.js"></script>
<script type="text/javascript" src="includes/product/scripts/jquery/jquery.tmpl.js"></script>
<script type="text/javascript" src="includes/product/scripts/jquery/jquery.tmpl.min.js"></script>
<script type="text/javascript" src="includes/product/scripts/jquery/jquery.toggleval.js"></script>
<script type="text/javascript" src="includes/product/scripts/localnav.js"></script>
<script type="text/javascript" src="includes/product/scripts/suggest.js"></script>
<script type="text/javascript">//<![CDATA[
var suggestionsObj;
            $(function() {
                var searchField = $('#docsearch');
                suggestionsObj = new Suggestions(getSuggestions, getMore, searchField);
            });
        
            function getSuggestions() {
               var text = suggestionsObj.searchField.val();
               document.location='docsuggestion:' + text;
            }

            function getMore(type) {
                var text = suggestionsObj.searchField.val();
                document.location='docsuggestion:' + type + ':' + text;
            }
//]]></script>
</head>

<body>
<div class="site_container site_toc_opened">
	<!--close_toc_pane-->
		<div class="page_container">
		<div class="content_frame">
			<div class="content_container" id="content_container">
				<br />
				
				<div itemprop="content">
					<h1 class="r2013b" itemprop="title">ECG heartbeat classification</h1>
					<!-- SYNCHTO: _funcalpha.html -->
						<div class="doc_topic_desc">
						<div class="purpose_container">
							<p itemprop="purpose">This document describes 
							 how to classify heartbeats according to its 
							 origin.</p>
							<div class="switch">
								<a href="javascript:void(0);" id="expandAllPage">expand 
								 all in page</a> 
							</div>
						</div>
					</div>
				</div>
				<div itemprop="content">
					<div class="clear">
						<p>&#160;</p>
					</div>
					<div class="examples">
						<div class="clear">
							<p>&#160;</p>
						</div>
						<div class="examples">
							<a name="Description"></a> 
							<h1 id="description1" class="r2013b">Description</h1>
							<p>This task implements a heartbeat classifier 
							 that follows the <a href="http://marketplace.aami.org/eseries/scriptcontent/docs/Preview Files/EC57_1212_preview.pdf">EC-57 
							 AAMI recommendation</a> classifying heartbeats 
							 into four classes:</p>
							<ul>
								<li><b>N</b> normal</li>
								<li><b>S</b> supraventricular</li>
								<li><b>V</b> ventricular</li>
								<li><b>F</b> fusion of normal and ventricular</li>
							</ul>
							<p>Each class and certain background regarding 
							 this topic are explained in my <a href="http://i3a.unizar.es/postgrado/descarga_tesis_pdf.php?ver=48">PhD 
							 thesis</a>, which can be useful f</p>
						</div>
					</div>
				</div>
				<div itemprop="content">
					<div class="clear">
						<p>&#160;</p>
					</div>
					<h1 id="inputs" class="r2013b">Input Arguments</h1>
					<div class="expandableContent">
						<div class="arguments">
							<div class="input_argument_container">
								<div class="expandableContent">
									<a name="inputarg_progress_handle"></a> 
									 
									<h3 id="input_argument_namevalue_outputdir" 
										 class="expand"><span class="argument_name"><a 
									 href="javascript:void(0);" title="Expand/Collapse" 
									 style="display: block;"><tt>progress_handle</tt> 
									 — used to track the progress within 
									 your function.</a></span><span class="example_desc"><tt>[]</tt> 
									 (default)</span></h3>
									<div class="collapse">
										<p>progress_handle, is a handle 
										 to a <a href="progress_bar.htm">progress_bar</a> 
										 object, that can be used to track 
										 the progress within your function.</p>
									</div>
								</div>
								<div class="expandableContent">
									<a name="inputarg_tmp_path"></a> 
									<h3 id="input_argument_namevalue_tmp_path" 
										 class="expand"><span><a href="javascript:void(0);" 
									 title="Expand/Collapse" style="display: block;"><span 
									 class="argument_name"><tt>tmp_path</tt> 
									 — The path to store temporary data</span></a><span 
									 class="example_desc"><tt>'tempdir()'</tt> 
									 (default)</span></span></h3>
									<div class="collapse">
										<p>Full path to a directory with 
										 write privileges.</p>
									</div>
								</div>
								<div class="expandableContent">
									<a name="inputarg_payload"></a> 
									<h3 id="input_argument_namevalue_payload" 
										 class="expand"><span><a href="javascript:void(0);" 
									 title="Expand/Collapse" style="display: block;"><span 
									 class="argument_name"><tt>payload</tt> 
									 — An arbitrary format variable to 
									 be passed to your user-defined algorithm.</span></a><span 
									 class="example_desc"><tt>[]</tt> (default)</span></span></h3>
									<div class="collapse">
										<p>This variable can be useful 
										 for passing data to your own function, 
										 not covered in the interface described 
										 <a href="#Adding_a_custom_detection_algorithm">below</a>.</p>
									</div>
								</div>
								<div class="expandableContent">
									<a name="inputarg_payload"></a> 
									<h3 id="input_argument_namevalue_payload" 
										 class="expand"><span><a href="javascript:void(0);" 
									 title="Expand/Collapse" style="display: block;"><span 
									 class="argument_name"><tt>mode</tt> 
									 — Set the algorithm mode of operation.</span></a><span 
									 class="example_desc"><tt>'auto'</tt> 
									 (default)</span></span></h3>
									<div class="collapse">
										<p>A string with any of the following 
										 names</p>
										<p style="margin-left: 40px;">'auto', 
										 this mode performs in automatic 
										 mode.</p>
										<p style="margin-left: 40px;">'slightly-assisted', 
										 this mode requires that an expert 
										 labels several heartbeats</p>
										<p style="margin-left: 40px;">'assisted', 
										 this mode is completely assisted. 
										 An expert must label some heartbeats.</p>
										<p>A more detailed </p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div itemprop="content">
					<div class="examples">
						<h1 id="examples" class="r2013b">Examples</h1>
						<p>The first example shows the simplest setup of 
						 the <span style="font-style: italic;">ECGtask_heartbeat_classifier</span> 
						 object, while at the end of this section a complete 
						 example with a real signal is shown.</p>
						<pre class="codeinput">
<span class="comment">
% with the task name</span>
	ECG_w.ECGtaskHandle = <span class="string">'ECG_heartbeat_classifier'</span>;<span class="comment">
% or create an specific handle to have more control</span>
	ECGt = ECGtask_heartbeat_classifier();</pre>
						<p>and then you are ready to setup the task</p>
						<pre class="codeinput">
<span class="comment">% select a mode, automatic mode does not require assistance</span>
	ECGt.mode = <span class="string">'auto'</span>;<span class="comment">
% this is to use QRS detection previously calculated</span>
	cached_filenames = ECG_all_wrappers(ii).GetCahchedFileName({<span class="string">'QRS_corrector' 'QRS_detection'</span>});
	ECGt.payload = load(cached_filenames{1})</pre>
						<p>Finally set the task to the wrapper object, 
						 and execute the task.</p>
						<pre class="codeinput">
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_w.ECGtaskHandle= ECGt; <span class="comment">% set the ECG task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_w.Run();</pre>
						<p style="line-height: 1.25em; max-width: 64em; 
							 color: #000000; font-family: Arial, sans-serif; 
							 font-size: 13.1199998855591px; font-style: normal; 
							 font-variant: normal; font-weight: normal; 
							 letter-spacing: normal; orphans: auto; text-align: start; 
							 text-indent: 0px; text-transform: none; white-space: normal; 
							 widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;">This 
						 example shows in first place, the previous configuration 
						 used in recording 208 from MIT Arrhythmia database. 
						 </p>
						<pre class="codeinput">
&gt;&gt; ECG_w = ECGwrapper( ...
		<span style="color: #A020F0;">'recording_name'</span>, <span style="color: #A020F0;">'some_path\208'</span>, ...
		<span style="color: #A020F0;">'recording_format'</span>, <span style="color: #A020F0;">'MIT'</span>, ...
		<span style="color: #A020F0;">'ECGtaskHandle'</span>, <span style="color: #A020F0;">'</span><span class="string">ECG_heartbeat_classifier</span><span style="color: #A020F0;">'</span>, ...
		)<?rh-implicit_p ?>ECG_w = 
############################
# <span style="color: #0000ff;"><strong>ECGwrapper object config</strong></span> #
############################
+ECG recording: <span style="color: #0000ff;"><strong>some_path\208 (auto)</strong></span>
+PID: 1/1
+Repetitions: 1
+Partition mode: ECG_overlapped
+Function name: ECG_heartbeat_classifier
+Processed: <span style="color: #ff0000;"><strong>false</strong></span>
					
&gt;&gt; ECG_w.Run();</pre>
						<p>You can follow the evolution in the progress 
						 bar, and after a while, it ends and display the 
						 classification results</p>
						<pre class="codeinput">
Configuration 
------------- 
+ Recording: ... \example recordings\208.dat (MIT) 
+ Mode: auto (12 clusters, 1 iterations, 75% cluster-presence) 
&#160;
&#160;&#160;True &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| Estimated Labels 
&#160;&#160;Labels &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| Normal Suprav Ventri Unknow| Totals 
&#160;-----------------|----------------------------|------- 
&#160;&#160;Normal &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| 1567 &#160;&#160;&#160;&#160;&#160;6 &#160;&#160;&#160;&#160;13 &#160;&#160;&#160;&#160;&#160;0 &#160;| 1586 
&#160;&#160;Supraventricular| &#160;&#160;&#160;2 &#160;&#160;&#160;&#160;&#160;0 &#160;&#160;&#160;&#160;&#160;0 &#160;&#160;&#160;&#160;&#160;0 &#160;| &#160;&#160;&#160;2 
&#160;&#160;Ventricular &#160;&#160;&#160;&#160;| &#160;255 &#160;&#160;&#160;&#160;&#160;8 &#160;&#160;1102 &#160;&#160;&#160;&#160;&#160;0 &#160;| 1365 
&#160;&#160;Unknown &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| &#160;&#160;&#160;2 &#160;&#160;&#160;&#160;&#160;0 &#160;&#160;&#160;&#160;&#160;0 &#160;&#160;&#160;&#160;&#160;0 &#160;| &#160;&#160;&#160;2 
&#160;-----------------|----------------------------|------- 
&#160;&#160;Totals &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| 1826 &#160;&#160;&#160;&#160;14 &#160;&#160;1115 &#160;&#160;&#160;&#160;&#160;0 &#160;| 2955 
&#160;
Balanced Results for 
--------------------- 
| Normal &#160;&#160;&#160;|| Supravent || Ventricul || &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TOTALS &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| 
| &#160;Se &#160;&#160;+P &#160;|| &#160;Se &#160;&#160;+P &#160;|| &#160;Se &#160;&#160;+P &#160;|| &#160;&#160;Acc &#160;&#160;| &#160;&#160;Se &#160;&#160;&#160;| &#160;&#160;+P &#160;&#160;&#160;| 
| &#160;99% &#160;45% || &#160;&#160;0% &#160;&#160;0% || &#160;81% &#160;99% || &#160;&#160;60% &#160;&#160;| &#160;&#160;60% &#160;&#160;| &#160;&#160;48% &#160;&#160;| 
&#160;
Unbalanced Results for 
----------------------- 
| Normal &#160;&#160;&#160;|| Supravent || Ventricul || &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TOTALS &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;| 
| &#160;Se &#160;&#160;+P &#160;|| &#160;Se &#160;&#160;+P &#160;|| &#160;Se &#160;&#160;+P &#160;|| &#160;&#160;Acc &#160;&#160;| &#160;&#160;Se &#160;&#160;&#160;| &#160;&#160;+P &#160;&#160;&#160;| 
| &#160;99% &#160;86% || &#160;&#160;0% &#160;&#160;0% || &#160;81% &#160;99% || &#160;&#160;90% &#160;&#160;| &#160;&#160;60% &#160;&#160;| &#160;&#160;62% &#160;&#160;|</pre>
						<p style="line-height: 1.25em; max-width: 64em; 
							 color: #000000; font-family: Arial, sans-serif; 
							 font-size: 13.1199998855591px; font-style: normal; 
							 font-variant: normal; font-weight: normal; 
							 letter-spacing: normal; orphans: auto; text-align: start; 
							 text-indent: 0px; text-transform: none; white-space: normal; 
							 widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;">This 
						 is possible because this recording include the 
						 expert annotations, or ''ground truth'', for each 
						 heartbeat. The manual annotations in MIT format 
						 are typically included in ''.atr'' files (in this 
						 case ''208.atr''). Now you can try ''slightly-assisted'' 
						 mode, where the algorithm may ask you for help 
						 in case of cluster heterogeneity. If this happens, 
						 a window like this will appear:</p>
						<p style="line-height: 1.25em; max-width: 64em; 
							 color: #000000; font-family: Arial, sans-serif; 
							 font-size: 13.1199998855591px; font-style: normal; 
							 font-variant: normal; font-weight: normal; 
							 letter-spacing: normal; orphans: auto; text-align: start; 
							 text-indent: 0px; text-transform: none; white-space: normal; 
							 widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img 
						 src="2D__Mariano_misc_a2hbc_doc_expert_user_interface.png" 
						 alt="" style="border: 0px; max-width: 100%;" border="0" /></p>
						<p style="line-height: 1.25em; max-width: 64em; 
							 color: #000000; font-family: Arial, sans-serif; 
							 font-size: 13.1199998855591px; font-style: normal; 
							 font-variant: normal; font-weight: normal; 
							 letter-spacing: normal; orphans: auto; text-align: start; 
							 text-indent: 0px; text-transform: none; white-space: normal; 
							 widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;">In 
						 this window the algorithm is asking you to label 
						 the centroid of the cluster, that is showed in 
						 the left panel. In the top of each panel some 
						 information is showed, as the amount of heartbeats 
						 in the current cluster. In the middle panel, you 
						 have some examples of heartbeats close to the 
						 centroid in a likelihood sense. The same is repeated 
						 in the right panel, but with examples far from 
						 the centroid. This manner you can have an idea 
						 of the dispersion of heartbeats within a cluster. 
						 Large differences across the panels indicates 
						 large cluster dispersion. If you decide to label 
						 the cluster, you can use one of the 4 buttons 
						 on your right. The unknown class is reserved for 
						 the cases where you can not make a confident decision. 
						 At the same time, in the command window, a suggestion 
						 appears:</p>
						<pre class="codeinput">
Configuration 
------------- 
+ Recording: .\example recordings\208.dat (MIT) 
+ Mode: assisted (3 clusters, 1 iterations, 75% cluster-presence) 
Suggestion: Normal
					</pre>
						<p style="line-height: 1.25em; max-width: 64em; 
							 color: #000000; font-family: Arial, sans-serif; 
							 font-size: 13.1199998855591px; font-style: normal; 
							 font-variant: normal; font-weight: normal; 
							 letter-spacing: normal; orphans: auto; text-align: start; 
							 text-indent: 0px; text-transform: none; white-space: normal; 
							 widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;">This 
						 means that the centroid heartbeat in the ''.atr'' 
						 file is labeled as ''Normal''. You will see this 
						 suggestion for each cluster analyzed, if there 
						 are annotations previously available. You are 
						 informed about the percentage of heartbeats already 
						 labeled with a progress bar, in the bottom of 
						 the control panel window.</p>
						<p style="line-height: 1.25em; max-width: 64em; 
							 color: #000000; font-family: Arial, sans-serif; 
							 font-size: 13.1199998855591px; font-style: normal; 
							 font-variant: normal; font-weight: normal; 
							 letter-spacing: normal; orphans: auto; text-align: start; 
							 text-indent: 0px; text-transform: none; white-space: normal; 
							 widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;">In 
						 case you believe that a cluster includes several 
						 classes of heartbeats, you can decide to ''skip'' 
						 the classification, and try to re-cluster those 
						 heartbeats in the next iteration. You are free 
						 to perform as many iterations as you decide, by 
						 skipping clusters. The refresh button resamples 
						 heartbeats close and far from the centroid, and 
						 then redraw the middle and right panels. This 
						 feature is useful for large clusters.</p>
						<p>You can check the result of this task for every 
						 heartbeat in the recording using the <a href="plot_ecg_strip.htm">visualization 
						 functions</a>.</p>
						<p>Also check this <a href="examples.html#Automatic_Heartbeat_classification">example</a> 
						 for further information.</p>
					</div>
					<div class="moreabout">
						<div class="clear">
							<p>&#160;</p>
						</div>
						<h1 id="moreabout" class="r2013b">More About</h1>
						<p>Here are some external references about heartbeat 
						 classification:</p>
						<ul style="list-style: disc;">
							<li><p><a href="http://marketplace.aami.org/eseries/scriptcontent/docs/Preview Files/EC57_1212_preview.pdf">EC-57 
							 AAMI recommendation</a></p></li>
							<li><p><a href="http://www.eplimited.com/confirmation.htm">EP 
							 limited</a> software</p></li>
						</ul>
					</div>
					<h1 class="r2013b">See Also</h1>
					<p><span itemprop="seealso"><a itemprop="url" href="ECGtask.html"><span 
					 itemprop="name"><tt>ECGtask</tt></span></a></span> 
					 | <span itemprop="seealso"><a itemprop="url" href="ECGdelineation.htm"><span 
					 itemprop="name"><tt>ECG delineation</tt></span></a></span> 
					 | <span itemprop="seealso"><a itemprop="url" href="examples.html"><span 
					 itemprop="name"><tt>examples</tt></span></a></span> 
					 </p>
				<!-- close_content_container -->
				</div>
			<!-- close_content_frame -->
			</div>
		<!--  close_page_container -->
		</div>
	</div>
</div>
<!--  close_site_container -->
</body>
</html>
