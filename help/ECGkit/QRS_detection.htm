<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta charset="utf-8" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="chunktype" content="refpage" />
<meta name="refentity" itemprop="refentity" content="function:ECGwrapper" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="toctype" itemprop="pagetype" content="fcn" />
<meta name="infotype" itemprop="infotype" content="ref/function" />
<meta name="description" itemprop="description" content="This MATLAB function generates a view of a MATLAB file in HTML format for sharing your code." />
<meta name="generator" content="Adobe RoboHelp 11" />
<title>QRS_detection</title>
<link rel="StyleSheet" href="merged.css" type="text/css" />
<script type="text/javascript" src="includes/product/scripts/jquery/jquery-latest.js"></script>
<script type="text/javascript" src="includes/shared/scripts/l10n.js"></script>
<script type="text/javascript" src="includes/shared/scripts/docscripts.js"></script>
<script type="text/javascript" src="includes/product/scripts/docscripts.js"></script>
<script type="text/javascript" src="includes/shared/scripts/mw.toc.js"></script>
<script type="text/javascript" src="includes/shared/scripts/mw.imagescaling.js"></script>
<script type="text/javascript" src="includes/shared/scripts/mw.imageanimation.js"></script>
<script type="text/javascript" src="includes/shared/scripts/mw.breadcrumb.js"></script>
<script type="text/javascript" src="includes/shared/scripts/jquery.highlight.js"></script>
<script type="text/javascript" src="includes/shared/scripts/nanoscroller.min.js"></script>
<script type="text/javascript" src="includes/product/scripts/jquery/jquery.tmpl.js"></script>
<script type="text/javascript" src="includes/product/scripts/jquery/jquery.tmpl.min.js"></script>
<script type="text/javascript" src="includes/product/scripts/jquery/jquery.toggleval.js"></script>
<script type="text/javascript" src="includes/product/scripts/localnav.js"></script>
<script type="text/javascript" src="includes/product/scripts/suggest.js"></script>
<script type="text/javascript">//<![CDATA[
var suggestionsObj;
            $(function() {
                var searchField = $('#docsearch');
                suggestionsObj = new Suggestions(getSuggestions, getMore, searchField);
            });
        
            function getSuggestions() {
               var text = suggestionsObj.searchField.val();
               document.location='docsuggestion:' + text;
            }

            function getMore(type) {
                var text = suggestionsObj.searchField.val();
                document.location='docsuggestion:' + type + ':' + text;
            }
//]]></script>
</head>

<body>
<div class="site_container site_toc_opened">
	<!--close_toc_pane-->
		<div class="page_container">
		<div class="content_frame">
			<div class="content_container" id="content_container">
				<div itemprop="content">
					<h1 class="r2013b" itemprop="title">QRS detection</h1>
					<p class="r2013b">This document describes how to perform 
					 QRS detection.</p>
				</div>
			</div>
			<div class="clear">
				<p>&#160;</p>
			</div>
			<div itemprop="content">
				<h1 id="inputs" class="r2013b">Description</h1>
				<p>Heartbeat detection is probably one of the first and 
				 most important tasks when you process cardiovascular recordings. 
				 The ECGkit has several algorithms to achieve this, such 
				 as:</p>
				<ul style="list-style: disc;">
					<li><a href="http://diec.unizar.es/~laguna/personal/publicaciones/wavedet_tbme04.pdf">Wavedet</a></li>
					<li><a href="http://www.physionet.org/physiotools/wag/gqrs-1.htm">gqrs</a></li>
					<li><a href="http://www.physionet.org/physiotools/wag/wqrs-1.htm">wqrs</a></li>
					<li><a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?reload=true&amp;arnumber=4122029">Pan 
					 and Tompkins</a>&#160;</li>
					<li><a href="http://www.physionet.org/physiotools/ecgpuwave/">ECGpuwave</a></li>
					<li>Aristotle</li>
				</ul>
				<p>You can use any or all the algorithms as you will see 
				 below or you can even add your own algorithms if you follow 
				 an easy interface, as described <a href="#Adding_a_custom_detection_algorithm">below</a>. 
				 The results are stored in a single file, that you can 
				 use to perform other subsequent tasks, such as <a href="ECGdelineation.htm">ECG 
				 delineation</a> or even the visual <a href="plot_ecg_strip.htm">inspection</a> 
				 or <a href="QRScorrector.htm">correction</a> of the algorithms 
				 results. For a quick reference about &#160;heartbeat detection 
				 you may want to check &#160;this <a href="examples.html#QRS_automatic_detection">example</a></p>
			</div>
			<div itemprop="content">
				<h1 id="inputs" class="r2013b">Properties</h1>
				<p>The public properties are:</p>
				<div class="expandableContent">
					<div class="arguments">
						<div class="input_argument_container">
							<div class="expandableContent">
								<a name="inputarg_progress_handle"></a> 
								 
								<h3 id="input_argument_namevalue_outputdir" 
									 class="expand"><span class="argument_name"><a 
								 href="javascript:void(0);" title="Expand/Collapse" 
								 style="display: block;"><tt>progress_handle</tt> 
								 — <tt>used to track the progress within 
								 your function.</tt></a></span><span class="example_desc"><tt>[]</tt> 
								 (default)</span></h3>
								<div class="collapse">
									<p>progress_handle, is a handle to 
									 a <a href="progress_bar.htm">progress_bar</a> 
									 object, that can be used to track 
									 the progress within your function.</p>
								</div>
							</div>
							<div class="expandableContent">
								<a name="inputarg_tmp_path"></a> 
								<h3 id="input_argument_namevalue_tmp_path" 
									 class="expand"><span><a href="javascript:void(0);" 
															 title="Expand/Collapse" 
															 style="display: block;"><span 
								 class="argument_name"><tt>tmp_path</tt> 
								 — The path to store temporary data</span></a><span 
								 class="example_desc"><tt>'tempdir()'</tt> 
								 (default)</span></span></h3>
								<div class="collapse">
									<p>Full path to a directory with write 
									 privileges.</p>
								</div>
							</div>
							<div class="expandableContent">
								<a name="inputarg_detectors"></a> 
								<h3 id="input_argument_namevalue_detectors" 
									 class="expand"><span class="argument_name"><a 
								 href="javascript:void(0);" title="Expand/Collapse" 
								 style="display: block;"><tt>detectors</tt> 
								 — The QRS detection algorithms to use</a></span><span 
								 class="example_desc"><tt>'all-detectors'</tt> 
								 (default)</span></h3>
								<div class="collapse">
									<p>A cell string or char with any of 
									 the following names</p>
									<p style="margin-left: 40px;">all-detectors</p>
									<p style="margin-left: 40px;"><a href="http://diec.unizar.es/~laguna/personal/publicaciones/wavedet_tbme04.pdf">wavedet</a></p>
									<p style="margin-left: 40px;"><a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?reload=true&amp;arnumber=4122029">pantom</a></p>
									<p style="margin-left: 40px;">aristotle</p>
									<p style="margin-left: 40px;"><a href="http://www.physionet.org/physiotools/wag/gqrs-1.htm">gqrs</a></p>
									<p style="margin-left: 40px;"><a href="http://www.physionet.org/physiotools/wag/sqrs-1.htm">sqrs</a></p>
									<p style="margin-left: 40px;"><a href="http://www.physionet.org/physiotools/wag/wqrs-1.htm">wqrs</a></p>
									<p style="margin-left: 40px;"><a href="http://www.physionet.org/physiotools/ecgpuwave/">ecgpuwave</a></p>
									<p style="margin-left: 40px;">&#160;</p>
								</div>
							</div>
							<div class="expandableContent">
								&#160; 
								<h3 id="input_argument_namevalue_outputdir" 
									 class="expand"><span><a href="javascript:void(0);" 
															 title="Expand/Collapse" 
															 style="display: block;"><span 
								 class="argument_name"><tt>only_ECG_leads</tt> 
								 — Process only ECG signals</span></a><span 
								 class="example_desc"><tt>true</tt> (default)</span></span></h3>
								<div class="collapse">
									<p>Boolean value. Find out which signals 
									 are ECG based on their header description.</p>
								</div>
							</div>
							<div class="expandableContent">
								<a name="inputarg_gqrs_config_filename"></a> 
								 
								<h3 id="input_argument_namevalue_gqrs_config_filename" 
									 class="expand"><span><a href="javascript:void(0);" 
															 title="Expand/Collapse" 
															 style="display: block;"><span 
								 class="argument_name"><tt>gqrs_config_filename</tt> 
								 — A configuration filename for the gqrs 
								 algorithm.</span></a><span class="example_desc"><tt>[]</tt> 
								 (default)</span></span></h3>
								<div class="collapse">
									<p>A full filename with the configuration 
									 for the gqrs algorithm. See the algorithm 
									 <a href="http://www.physionet.org/physiotools/wag/gqrs-1.htm">web</a> 
									 page for details.</p>
								</div>
							</div>
							<div class="expandableContent">
								<a name="inputarg_wavedet_config"></a> 
								 
								<h3 id="input_argument_namevalue_wavedet_config" 
									 class="expand"><span><a href="javascript:void(0);" 
															 title="Expand/Collapse" 
															 style="display: block;"><span 
								 class="argument_name"><tt>wavedet_config</tt> 
								 — A structure for customizing wavedet 
								 algorithm.</span></a><span class="example_desc"><tt>[]</tt> 
								 (default)</span></span></h3>
								<div class="collapse">
									<p>Undocumented yet, use only if you 
									 know what you are doing.</p>
								</div>
							</div>
							<a name="payload_prop"></a> 
							<div class="expandableContent">
								<a name="inputarg_payload"></a> 
								<h3 id="input_argument_namevalue_payload" 
									 class="expand"><span><a href="javascript:void(0);" 
															 title="Expand/Collapse" 
															 style="display: block;"><span 
								 class="argument_name"><tt>payload</tt> 
								 — An arbitrary format variable to be passed 
								 to your user-defined algorithm.</span></a><span 
								 class="example_desc"><tt>[]</tt> (default)</span></span></h3>
								<div class="collapse">
									<p>This variable can be useful for 
									 passing data to your own function, 
									 not covered in the interface described 
									 <a href="#Adding_a_custom_detection_algorithm">below</a>.</p>
								</div>
							</div>
							<div class="expandableContent">
								<a name="inputarg_CalculatePerformance"></a> 
								 
								<h3 id="input_argument_namevalue_CalculatePerformance" 
									 class="expand"><span><a href="javascript:void(0);" 
															 title="Expand/Collapse" 
															 style="display: block;"><span 
								 class="argument_name"><tt>CalculatePerformance</tt> 
								 — Calculate algorithm performances based 
								 on gold standard reference detections.</span></a><span 
								 class="example_desc"><tt>false</tt> (default)</span></span></h3>
								<div class="collapse">
									<p>Boolean value. Calculate the algorithm 
									 performance based on the reference 
									 annotations found by the ECGwrapper 
									 object in the same folder where the 
									 signals are. This reference annotations 
									 are loaded, if detected, in the ECG_annotations 
									 property.</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div itemprop="content">
				<div class="clear">
					<p>&#160;</p>
				</div>
				<div class="examples">
					<div itemprop="content">
						<a name="Adding_a_custom_detection_algorithm"></a> 
						 
						<h1 id="description1" class="r2013b">Adding a custom 
						 detection algorithm</h1>
						<p>Adding your own QRS detectors to the kit is 
						 very simple. Ensure that your function implements 
						 this interface:</p>
						<pre class="codeinput">
<p style="margin-left: 40px;"><span class="keyword">function</span> [positions_single_lead, position_multilead] = your_QRS_detector( ECG_matrix, ECG_header, progress_handle, payload_in)</p>
						</pre>
						<p>where the arguments are:</p>
						<p style="margin-left: 40px;">ECG_matrix, is a 
						 matrix size [ECG_header.nsamp ECG_header.nsig]</p>
						<p style="margin-left: 40px;">ECG_header, is a 
						 struct with info about the ECG signal, such as:</p>
						<p style="margin-left: 80px;">freq, the sampling 
						 frequency</p>
						<p style="margin-left: 80px;">desc, description 
						 about the signals.</p>
						<p style="margin-left: 40px;">progress_handle, 
						 is a handle to a <a href="progress_bar.htm">progress_bar</a> 
						 object, that can be used to track the progress 
						 within your function.</p>
						<p style="margin-left: 40px;">payload_in, is a 
						 user variable, of arbitrary format, allowed to 
						 be sent to your function. It is sent, via the 
						 <a href="#payload_prop">payload property</a> of 
						 this class, for example:</p>
						<pre class="codeinput">
<p style="margin-left: 80px;">this_ECG_wrappers.ECGtaskHandle.payload = your_variable;</p><p style="margin-left: 80px;">this_ECG_wrappers.ECGtaskHandle.payload = {your_var1 your_var2};</p><p style="margin-left: 80px;">this_ECG_wrappers.ECGtaskHandle.payload = load(cached_filenames);</p></pre>
						<p>and the output of your function must be:</p>
						<p style="margin-left: 40px;">positions_single_lead, 
						 a cell array size ECG_header.nsig with the&#160;QRS 
						 sample locations found in each lead.</p>
						<p style="margin-left: 40px;">position_multilead, 
						 a numeric vector with the QRS locations calculated 
						 using multilead rules.</p>
					</div>
					<h1 id="examples" class="r2013b">Examples</h1>
					<div class="expandableContent" id="expandableExamples">
						<p class="switch"><a href="javascript:void(0);" 
											 class="expandAllLink">collapse 
						 all</a></p>
						<div class="example_module expandableContent" id="example_1">
							<a name="ecgw_ex_noarg"></a> 
							<h3 class="expand"><span><a href="javascript:void(0);" 
														 title="Expand/Collapse" 
														 style="display: block;"><span 
							 class="example_title">Create the simplest 
							 ECG wrapper object</span></a></span></h3>
							<div class="collapse" style="display: none;">
								<p>Create the ECGwrapper object.</p>
								<pre class="programlisting codeinput">
&gt;&gt; ECG_w = ECGwrapper()
ECG_w = 
############################
# <span style="color: #0000ff;"><strong>ECGwrapper object config</strong></span> #
############################
+ECG recording: <span style="color: #ff0000;"><strong>None selected</strong></span>
+PID: 1/1
+Repetitions: 1
+Partition mode: ECG_overlapped
+Function name: <span style="color: #ff0000;"><strong>Null task</strong></span>
+Processed: <span style="color: #ff0000;"><strong>false</strong></span>
				</pre>
								<p>Then, in your script or in the command 
								 window you can type:</p>
								<pre class="programlisting codeinput">
&gt;&gt; ECG_w.recording_name = 'some_path\100';
&gt;&gt; ECG_w.ECGtaskHandle = 'QRS_detection'
ECG_w = 
############################
# <span style="color: #0000ff;"><strong>ECGwrapper object config</strong></span> #
############################
+ECG recording: <span style="color: #0000ff;"><strong>some_path\100 (auto)</strong></span>
+PID: 1/1
+Repetitions: 1
+Partition mode: ECG_overlapped
+Function name: QRS_detection
+Processed: <span style="color: #ff0000;"><strong>false</strong></span>
				</pre>
								<p>Now, you just want to run the task by 
								 executing:</p>
								<pre class="programlisting codeinput">
&gt;&gt; ECG_w.Run();
				</pre>
							</div>
						</div>
						<div class="example_module expandableContent" id="example_1">
							<a name="ecgw_ex_namevalue"></a> 
							<h3 class="expand"><span><a href="javascript:void(0);" 
														 title="Expand/Collapse" 
														 style="display: block;"><span 
							 class="example_title">Create an ECGwrapper 
							 object for an specific recording and task</span></a></span></h3>
							<div class="collapse" style="display: none;">
								<p>In this case, we create the same object 
								 of the previous example but using the 
								 name-value .</p>
								<pre class="programlisting codeinput">
&gt;&gt; ECG_w = ECGwrapper( ...
		<span style="color: #A020F0;">'recording_name'</span>, <span style="color: #A020F0;">'some_path\100'</span>, ...
		<span style="color: #A020F0;">'recording_format'</span>, <span style="color: #A020F0;">'MIT'</span>, ...
		<span style="color: #A020F0;">'ECGtaskHandle'</span>, <span style="color: #A020F0;">'QRS_detection'</span>, ...
		)
ECG_w = 
############################
# <span style="color: #0000ff;"><strong>ECGwrapper object config</strong></span> #
############################
+ECG recording: <span style="color: #0000ff;"><strong>some_path\100 (auto)</strong></span>
+PID: 1/1
+Repetitions: 1
+Partition mode: ECG_overlapped
+Function name: QRS_detection
+Processed: <span style="color: #ff0000;"><strong>false</strong></span>
					
&gt;&gt; ECG_w.Run();
				</pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="clear">
				<p>&#160;</p>
			</div>
			<div class="moreabout">
				<h1 id="moreabout" class="r2013b">More About</h1>
				<div class="expandableContent">
					<p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand 
					 all</a></p>
					<div class="expandableContent" itemprop="content">
						<a name="btbsnu4-2"></a> 
						<h3 class="expand"><span><a href="javascript:void(0);" 
													 title="Expand/Collapse" 
													 style="display: block;"><span>Other 
						 resources</span></a></span></h3>
						<div class="collapse">
							<ul>
								<li>Pan and Tompkins <a href="http://www.eplimited.com/software.htm" 
														 target="_blank">original 
								 implementation</a> and others implementations 
								 <a href="http://www.oset.ir/">1</a>, <a 
								 href="http://www.mathworks.com/matlabcentral/fileexchange/45840-complete-pan-tompkins-implementation-ecg-qrs-detector">2</a>.</li>
								<li><a href="http://thew-project.org/" 
										 target="_blank">Telemetric and 
								 Holter ECG Warehouse (THEW)</a></li>
								<li><a href="http://diec.unizar.es/~laguna/personal/publicaciones/publicaciones.htm" 
										 target="_blank">Pablo Laguna research 
								 group at University of Zaragoza</a></li>
								<li><a href="http://cinc.org/" target="_blank">Computing 
								 in Cardiology</a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<h1 class="r2013b">See Also</h1>
			<p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" 
					 itemprop="seealso"><a itemprop="url" href="ECGtask.html"><span 
			 itemprop="name"><tt>ECGtask</tt></span></a></span> | <span 
			 itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" 
			 itemprop="seealso"><a itemprop="url" href="examples.html"><span 
			 itemprop="name"><tt>examples</tt></span></a></span> </p>
		<!-- close_content_container -->
		</div>
	<!-- close_content_frame -->
	</div>
<!--  close_page_container -->
</div>
<!--  close_site_container -->
</body>
</html>
