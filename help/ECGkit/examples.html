<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage" 
 xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta charset="utf-8" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="toctype" itemprop="pagetype" content="cat" />
<meta name="infotype" itemprop="infotype" content="cat" />
<meta name="description" itemprop="description" content="Syntax, operators, data types, array indexing and manipulation" />
<meta name="generator" content="Adobe RoboHelp 11" />
<title>Examples</title>
<link rel="StyleSheet" href="merged.css" type="text/css" />
<script type="text/javascript" src="./includes/product/scripts/jquery/jquery-latest.js"></script>
<script type="text/javascript" src="./includes/shared/scripts/l10n.js"></script>
<script type="text/javascript" src="./includes/shared/scripts/docscripts.js"></script>
<script type="text/javascript" src="./includes/product/scripts/docscripts.js"></script>
<script type="text/javascript" src="./includes/shared/scripts/mw.toc.js"></script>
<script type="text/javascript" src="./includes/shared/scripts/mw.imagescaling.js"></script>
<script type="text/javascript" src="./includes/shared/scripts/mw.imageanimation.js"></script>
<script type="text/javascript" src="./includes/shared/scripts/mw.breadcrumb.js"></script>
<script type="text/javascript" src="./includes/shared/scripts/jquery.highlight.js"></script>
<script type="text/javascript" src="./includes/shared/scripts/nanoscroller.min.js"></script>
<script type="text/javascript" src="./includes/product/scripts/jquery/jquery.tmpl.js"></script>
<script type="text/javascript" src="./includes/product/scripts/jquery/jquery.tmpl.min.js"></script>
<script type="text/javascript" src="./includes/product/scripts/jquery/jquery.toggleval.js"></script>
<script type="text/javascript" src="./includes/product/scripts/localnav.js"></script>
<script type="text/javascript" src="./includes/product/scripts/suggest.js"></script>
<script type="text/javascript">//<![CDATA[
            var suggestionsObj;
            $(function() {
                var searchField = $('#docsearch');
                suggestionsObj = new Suggestions(getSuggestions, getMore, searchField);
            });
        
            function getSuggestions() {
               var text = suggestionsObj.searchField.val();
               document.location='docsuggestion:' + text;
            }

            function getMore(type) {
                var text = suggestionsObj.searchField.val();
                document.location='docsuggestion:' + type + ':' + text;
            }
//]]></script>
<script type="text/javascript">//<![CDATA[
           $(function() {
               $('h3.expand').click(function() {
                   var h3elt = $(this);
                   h3elt.siblings('.collapse').slideToggle();
                   h3elt.toggleClass('open');
                   h3elt.children('a').toggleClass('open'); 
               });
               $('h3.expand').wrapInner('<a style="display:block" href="#" title="Expand/Collapse" />');
           });
//]]></script>
<script type="text/javascript">//<![CDATA[

   $(document).ready(function(){

   
       if (location.hash == '#bth9dea-1') {
           $("li.bth9dea-1>h3").click()
       }
   
       if (location.hash == '#language-fundamentals') {
           $("li.language-fundamentals>h3").click()
       }
   
       if (location.hash == '#mathematics') {
           $("li.mathematics>h3").click()
       }
   
       if (location.hash == '#graphics') {
           $("li.graphics>h3").click()
       }
   
       if (location.hash == '#programming-and-data-types') {
           $("li.programming-and-data-types>h3").click()
       }
   
       if (location.hash == '#data-and-file-management') {
           $("li.data-and-file-management>h3").click()
       }
   
       if (location.hash == '#gui-development') {
           $("li.gui-development>h3").click()
       }
   
       if (location.hash == '#external-interfaces') {
           $("li.external-interfaces>h3").click()
       }
   
       if (location.hash == '#desktop-tools-and-development-environment') {
           $("li.desktop-tools-and-development-environment>h3").click()
       }
   

   });
//]]></script>
</head>

<body>
<h1 itemprop="title content" class="r2013b">ECGkit</h1>
<div class="doc_topic_desc" itemprop="content purpose">
	<p class="doc_topic_desc">A toolbox for cardiovascular signal processing 
	 </p>
</div>
	<h1 class="r2013b">Example of how to use the ECGkit</h1>
	<!--introduction-->
		<p>This script exemplifies the use of the ECGkit in a multimodal 
	 cardiovascular recording which includes arterial blood pressure (ABP), 
	 plethysmographic (PPG) and electrocardiogram signals. The following 
	 tasks will be performed in this example:</p>
	<div>
		<ul>
			<li>Heartbeat/QRS detection</li>
			<li>ABP/PPG pulse detection</li>
			<li>ECG wave delineation</li>
			<li>Heartbeat classification</li>
			<li>Report generation</li>
		</ul>
	</div>
	<p>Each automatic step is followed by a manual verification step in 
	 order to verify the algorithm's results. The script is prepared to 
	 run locally without arguments, as well as in a cluster environment 
	 by using &quot;pid_str&quot; argument. The pid_str argument is a char 
	 with format 'N/M', being N &lt;= M with default value '1/1'. You can 
	 partition a big job into M pieces in cluster architecture, by starting 
	 M processes with N ranging from 1 to M.</p>
	<p>You can watch a typical run of this script for small, local ECG 
	 recording on <a href="https://www.youtube.com/watch?v=8lJtkGhrqFw&amp;list=PLlD2eDv5CIe9sA2atmnb-DX48FIRG46z7">YouTube</a>.</p>
	<p><b style="font-weight: normal;">Example</b> of how to run this script</p>
	<pre class="codeinput">
examples()<?rh-implicit_p ?>examples(<span class="string">'1/1'</span>, <span class="string">'C:\Your_preferred_local_path\'</span>, <span class="string">'arbitrary_string'</span>)
examples(<span class="string">'1/10'</span>, <span class="string">'/Your_preferred_path_in_cluster/'</span>, <span class="string">'arbitrary_string'</span>)		
		</pre>
	<!--/introduction-->
		<h1 class="r2013b">Contents</h1>
	<div>
		<ul>
			<li><a href="#Function_prototype">Function prototype</a></li>
			<li><a href="#Argument_parsing">Argument parsing</a></li>
			<li><a href="#QRS_automatic_detection">QRS automatic detection</a></li>
			<li><a href="#QRS_visual_inspection_and_correction">QRS visual 
			 inspection and correction</a></li>
			<li><a href="#PPG_ABP_pulse_detection">PPG/ABP pulse detection</a></li>
			<li><a href="#PPG_ABP_waves_visual_inspection_and_correction">PPG/ABP 
			 waves visual inspection and correction</a></li>
			<li><a href="#ECG_automatic_delineation">ECG automatic delineation</a></li>
			<li><a href="#Visual_inspection_of_the_detection_delineation">Visual 
			 inspection of the detection/delineation</a></li>
			<li><a href="#Automatic_Heartbeat_classification">Automatic 
			 Heartbeat classification</a></li>
			<li><a href="#Visual_inspection_of_the_signal">Visual inspection 
			 of the signal</a></li>
			<li><a href="#Other_user-defined_tasks_">Other user-defined 
			 tasks ...</a></li>
		</ul>
	</div>
	<h1 class="r2013b">Function prototype<a name="Function_prototype"></a></h1>
	<pre class="codeinput">
<span class="keyword">function</span> examples(pid_str, examples_path, user_str)
		</pre>
	<p><i>examples</i> accepts three <i>optional</i> arguments:</p>
	<div>
		<ul>
			<li><b><i>pid_str</i></b> (optional) string identifier for 
			 this work instance in a cluster computing or multitask environment. 
			 The identifier follows the form 'N/M', being N a number which 
			 identifies this execution instance and M the total amount 
			 of instances. Default value '1/1'</li>
			<li><b><i>examples_path</i></b> (optional) string of the path 
			 with ECG recordings. Default value <tt>['.' filesep 'example_recordings' 
			 filesep ]</tt>;</li>
			<li><b><i>user_str</i></b> (optional) string to identify this 
			 run or experiment.</li>
		</ul>
	</div>
	<h1 class="r2013b">Argument parsing<a name="Argument_parsing"></a></h1>
	<p>Simple and straight forward.</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="keyword">if</span>( nargin &lt; 1 || ~ischar(pid_str) )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% single PID run</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pid_str = <span class="string">'1/1'</span>;
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">if</span>( nargin &lt; 2 || ~exist(examples_path, <span class="string">'dir'</span>) )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% inspect ECG files in rootpath\example_recordings\ folder</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;root_path = fileparts(mfilename(<span class="string">'fullpath'</span>));
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% default folder to look at</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;examples_path = [root_path filesep <span class="string">'example_recordings'</span> filesep ];
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>(~exist(examples_path, <span class="string">'dir'</span>))
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;disp_string_framed(2, <span class="string">'Please provide a valid path with ECG recordings'</span>);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">return</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">else</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( examples_path(end) ~= filesep )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;examples_path = [examples_path filesep];
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">if</span>( nargin &lt; 3 &#160;)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;user_str = <span class="string">''</span>;
&#160;&#160;&#160;&#160;<span class="keyword">end</span><span class="comment">
% Explore the *examples_path* for ECG recordings.</span>
&#160;&#160;&#160;&#160;filenames = dir(examples_path);
&#160;&#160;&#160;&#160;recnames = {filenames(:).name};<span class="comment">
% In this case I hardcoded only one recording</span>
&#160;&#160;&#160;&#160;recnames = {<span class="string">'ex_ABP_PPG_Registro_01M'</span>};<span class="comment">
% But you can use this to iterate for all of them.</span><span class="comment">
% &#160;&#160;&#160;&#160;[~,recnames] = cellfun(@(a)(fileparts(a)), recnames, 'UniformOutput', false);</span><span class="comment">
% &#160;&#160;&#160;&#160;recnames = unique(recnames);</span><span class="comment">
% &#160;&#160;&#160;&#160;recnames = setdiff(recnames, {'' '.' '..' 'results' 'condor' });</span><span class="comment">
% &#160;&#160;&#160;&#160;recnames = recnames(1)</span>
&#160;&#160;&#160;&#160;lrecnames = length(recnames);
&#160;&#160;&#160;&#160;<span class="comment">% In case of running in a user-assisted fashion.</span>
&#160;&#160;&#160;&#160;bUseDesktop = usejava(<span class="string">'desktop'</span>);
&#160;&#160;&#160;&#160;<span class="keyword">if</span>( bUseDesktop )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tmp_path = tempdir;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;output_path = [ examples_path <span class="string">'results'</span> filesep ];
&#160;&#160;&#160;&#160;<span class="keyword">else</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% For cluster or distributed environment processing.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;InstallECGkit();
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is a local path, usually faster to reach than output_path</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tmp_path = <span class="string">'/scratch/'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% distributed or cluster-wide accesible path</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;output_path = [ examples_path <span class="string">'results'</span> filesep ];
&#160;&#160;&#160;&#160;<span class="keyword">end</span><span class="comment">
% just for debugging, keep it commented.</span><span class="comment">
% &#160;&#160;&#160;&#160;bUseDesktop = false</span></pre>
	<h1 class="r2013b">QRS automatic detection<a name="QRS_automatic_detection"></a></h1>
	<p>In this example the first step is the location of each heartbeat, 
	 or QRS complexes detection. To achieve this, the kit includes the 
	 following algorithms:</p>
	<div>
		<ul>
			<li>Wavedet</li>
			<li>Pan &amp; Tompkins</li>
			<li>gqrs</li>
			<li>sqrs</li>
			<li>wqrs</li>
			<li>ecgpuwave</li>
		</ul>
	</div>
	<p>The way of performing QRS detection (or almost any other task in 
	 this ECGkit) is through an <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGwrapper')">ECGwrapper</a> 
	 object. The objective of this object is to abstract or sepparate any 
	 algorithm from the particular details of the ECG signal. This object 
	 is able to invoque any kind of algorithm through the interface provided 
	 of other object, called <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGwrapper')">ECGtask</a> 
	 obejcts.</p>
	<p>The <i>ECGtask</i> obejcts actually perform specific task on the 
	 ECG signal, in this case, the QRS complex detection. Each task have 
	 general properties such as <i>user_string</i>, <i>progress_handle</i> 
	 (see <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:edit('ECGtask.m')">ECGtask</a> 
	 class for more details) and other specific for a certain task, such 
	 as <i>detectors</i>, <i>only_ECG_leads</i>, <i>wavedet_config</i>, 
	 <i>gqrs_config_filename</i> (see others in <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:edit('ECGtask_QRS_detection.m')">QRS 
	 detection</a> task source).</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="comment">% go through all files</span>
&#160;&#160;&#160;&#160;ECG_all_wrappers = [];
&#160;&#160;&#160;&#160;jj = 1;
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;rec_filename = [examples_path recnames{ii}];
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% task name,</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd = 'QRS_detection';</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% or create an specific handle to have more control</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd = ECGtask_QRS_detection();<span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;% select an specific algorithm. Default: Run all detectors</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = 'wavedet'; % Wavedet algorithm based on</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = 'pantom'; &#160;% Pan-Tompkins alg.</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = 'gqrs'; &#160;&#160;&#160;% WFDB gqrs algorithm.</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = 'user:example_worst_ever_QRS_detector'; &#160;&#160;&#160;% Example of how you can add your own QRS detector.</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = 'user:your_QRS_detector_func_name'; &#160;&#160;&#160;%</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;your_QRS_detector_func_name&quot; can be your own detector.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = {<span class="string">'wavedet'</span> <span class="string">'gqrs'</span> <span class="string">'wqrs'</span> <span class="string">'user:example_worst_ever_QRS_detector'</span>};
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% you can individualize each run of the QRS detector with an</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% external string</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.user_string = user_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% or group by the config used</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.user_string = ECGt_QRSd.detectors;</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.only_ECG_leads = false; &#160;&#160;&#160;% consider all signals ECG</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.only_ECG_leads = true; &#160;&#160;&#160;<span class="comment">% Identify ECG signals based on their header description.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_w = ECGwrapper( <span class="string">'recording_name'</span>, rec_filename, <span class="keyword">...</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="string">'this_pid'</span>, pid_str, <span class="keyword">...</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="string">'tmp_path'</span>, tmp_path, <span class="keyword">...</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="string">'output_path'</span>, output_path, <span class="keyword">...</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="string">'ECGtaskHandle'</span>, ECGt_QRSd);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">try</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% process the task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_w.Run;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% collect object if were recognized as ECG recordings.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( jj == 1)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers = ECG_w;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">else</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(jj) = ECG_w;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jj = jj + 1;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">catch</span> MException
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( strfind(MException.identifier, <span class="string">'ECGwrapper:ArgCheck:InvalidFormat'</span>) )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;disp_string_framed(<span class="string">'*Red'</span>, sprintf( <span class="string">'Could not guess the format of %s'</span>, ECG_w.recording_name) );
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">else</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% report just in case</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;report = getReport(MException);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fprintf(2, <span class="string">'\n%s\n'</span>, report);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="comment">% recognized recordings</span>
&#160;&#160;&#160;&#160;lrecnames = length(ECG_all_wrappers);
&#160;&#160;&#160;&#160;<span class="comment">% at the end, report problems if happened.</span>
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ReportErrors;
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
	<h1 class="r2013b">QRS visual inspection and correction<a name="QRS_visual_inspection_and_correction"></a></h1>
	<p>This part of the example uses a graphical user interface (GUI) to 
	 allow the user correcting mistakes that the previous automatic algorithm 
	 eventually makes.</p>
	<p>As can be seen in the following code, the first step is checking 
	 that the previous QRS detection task finished without problems. Then 
	 if no errors, the corrector will use as starting point the result 
	 of this same task, in case the user would like to edit a previously 
	 edited result, or if not available the result of the QRS detection 
	 task.</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="keyword">if</span>( bUseDesktop )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% other task can be performed on the same objects</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% last worker is the responsible of the visual correction.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ECG_all_wrappers(ii).this_pid == ECG_all_wrappers(ii).cant_pids)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if there are not any previous error.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ECG_all_wrappers(ii).Processed &amp;&amp; ~ECG_all_wrappers(ii).Error )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous saved results as starting point,</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any available</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cached_filenames = ECG_all_wrappers(ii).GetCahchedFileName({<span class="string">'QRS_corrector'</span> <span class="string">'QRS_detection'</span>});
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if no previous correction work, try the automatic</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% detection task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any, do the correction</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ~isempty(cached_filenames) )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous saved results as starting point,</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any available</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle = <span class="string">'QRS_corrector'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% This task is supposed to be supervised, so only one pid is enough.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).this_pid = <span class="string">'1/1'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% user provided name to individualize each run</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.user_string = user_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% to avoid loading cached results and exit, this flag</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% allows the re-editing of the current state of the</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% detections.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).cacheResults = false;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% maybe in your application you should run this for</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% all files.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.payload = load(cached_filenames{1});
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% process the task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).Run;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% restore the original pids configuration</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).this_pid = pid_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% As we changed for &quot;QRS correction&quot; task, we have to enable this</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% value again in order to avoid performing the following tasks every time.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% If you want to recalculate any task, change it to false</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).cacheResults = true;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% at the end, report problems if happened.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ReportErrors;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
	<p>Then the task invoked by the wrapper object is changed to <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:edit('ECGtask_QRS_corrector.m')">QRS 
	 corrector task</a> and the GUI is presented to the user.</p>
	<p><img src="QRS corrector.PNG" alt="" style="margin-top: 5px; margin-bottom: 5px; 
			 margin-left: 5px; margin-right: 5px;" border="0" /></p>
	<p>In this example, the GUI have four plots to represent the RR interval 
	 series, the two in the top-left show the RR interval versus time at 
	 different time windows. The bigger in the top-right, shows a <i>Poincaré</i> 
	 plot, that is the current RR interval versus the following in the 
	 serie. The plot in the bottom shows the selected signal/s versus time. 
	 Then the user can interact with the plots according to the <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_QRS_corrector')">QRS 
	 corrector documentation</a></p>
	<h1 class="r2013b">PPG/ABP pulse detection<a name="PPG_ABP_pulse_detection"></a></h1>
	<p>In case the recording includes pulsatile signals, such as plethysmographic 
	 (PPG) or arterial blood pressure (ABP), this kit includes the <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_PPG_ABP_detector')">PPG/ABP 
	 automatic detector task</a> which allows the use of two algorithms 
	 to perform peak detection, <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('PPG_pulses_detector')">WavePPG</a> 
	 and <a href="wabp-1.htm','-browser')">Physionet's wabp</a>.</p>
	<p>other task can be performed on the same objects</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% set the delineator task name and run again.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle = <span class="string">'PPG_ABP_detector'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% user provided name to individualize each run</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.user_string = user_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% process the task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).Run;
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="comment">% at the end, report problems if happened.</span>
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ReportErrors;
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
	<h1 class="r2013b">PPG/ABP waves visual inspection and correction<a 
	 name="PPG_ABP_waves_visual_inspection_and_correction"></a></h1>
	<p>The same manual verification made for automatic QRS detection algorithms 
	 can be performed with pulsatile signals. The <a href="../../../../../../jsD:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_PPG_ABP_corrector')">PPG/ABP 
	 corrector task</a> was designed to allow users the verification and 
	 correction of automatic detections through the same GUI.</p>
	<p><img src="PPG-ABP corrector.PNG" alt="" style="margin-top: 5px; 
			 margin-bottom: 5px; margin-left: 5px; margin-right: 5px;" 
			 border="0" /></p>
	<p>The following code shows how to use this task. As you can note, 
	 the interface is almost the same used for the QRS correction task.</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="keyword">if</span>( bUseDesktop )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% other task can be performed on the same objects</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% last worker is the responsible of the visual correction.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ECG_all_wrappers(ii).this_pid == ECG_all_wrappers(ii).cant_pids)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if there are not any previous error.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ECG_all_wrappers(ii).Processed &amp;&amp; ~ECG_all_wrappers(ii).Error )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous saved results as starting point,</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any available</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cached_filenames = ECG_all_wrappers(ii).GetCahchedFileName({<span class="string">'PPG_ABP_corrector'</span> <span class="string">'PPG_ABP_detector'</span>});
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if no previous correction work, try the automatic</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% detection task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any, do the correction</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ~isempty(cached_filenames) )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous saved results as starting point,</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any available</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle = <span class="string">'PPG_ABP_corrector'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% This task is supposed to be supervised, so only one pid is enough.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).this_pid = <span class="string">'1/1'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% user provided name to individualize each run</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.user_string = user_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% to avoid loading cached results and exit, this flag</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% allows the re-editing of the current state of the</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% detections.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).cacheResults = false;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% maybe in your application you should run this for</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% all files.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.payload = load(cached_filenames{1});
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% process the task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).Run;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% restore the original pids configuration</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).this_pid = pid_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% As we changed for &quot;QRS correction&quot; task, we have to enable this</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% value again in order to avoid performing the following tasks every time.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% If you want to recalculate any task, change it to false</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).cacheResults = true;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% at the end, report problems if happened.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ReportErrors;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
	<h1 class="r2013b">ECG automatic delineation<a name="ECG_automatic_delineation"></a></h1>
	<p>Once the QRS complexes were detected, each heartbeat can be segmented 
	 or delineated into P-QRS-T waves. To achieve this the kit includes 
	 an <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_ECG_delineation')">ECG 
	 delineation task</a> to interface with the <a href="articleDetails.jsp?arnumber=1275572','-browser')">wavedet</a> 
	 and others user-defined algorithms, as described in the <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_ECG_delineation')">task 
	 help</a>. The interface follows the same guidelines described before, 
	 as is shown in the following code.</p>
	<p>other task can be performed on the same objects</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous cached results as starting point</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cached_filenames = ECG_all_wrappers(ii).GetCahchedFileName(<span class="string">'QRS_corrector'</span>);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if corrected QRS detections are not available, wavedet</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% performs automatic QRS detection.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ~isempty(cached_filenames) )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous result from the automatic QRS</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% detection</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.payload = load(cached_filenames{1});
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% set the delineator task name and run again.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle = <span class="string">'ECG_delineation'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% user provided name to individualize each run</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.user_string = user_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% Identify ECG signals based on their header description and</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% perform delineation in those leads.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.only_ECG_leads = true;<span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = 'wavedet'; % Wavedet algorithm based on</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = 'user:example_worst_ever_ECG_delineator';</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;% Example of how you can add your own ECG delineator.</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECGt_QRSd.detectors = 'user:your_ECG_delineator_func_name';</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;your_ECG_delineator_func_name&quot; can be your own delineator.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.delineators = {<span class="string">'wavedet'</span> <span class="string">'user:example_worst_ever_ECG_delineator'</span>};
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% process the task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).Run;
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="comment">% at the end, report problems if happened.</span>
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ReportErrors;
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
	<h1 class="r2013b">Visual inspection of the detection/delineation<a 
	 name="Visual_inspection_of_the_detection_delineation"></a></h1>
	<p>The same manual verification made for all the previous automatic 
	 tasks is repeated for ECG delineation. The <a href="../../../../../../jsD:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_ECG_delineation_corrector')">ECG 
	 delineation corrector task</a> was designed to allow users the verification 
	 and correction of automatic delineation through the same GUI. The 
	 only difference with respect to the behaviour of the QRS or PPG/ABP 
	 correction GUI, is that addition of new events to the P-QRS-T series 
	 is not allowed, in order to keep the assosiation of a wave fiducial 
	 point to a heartbeat.</p>
	<p><img src="ECG delineator corrector.png" alt="" style="margin-top: 5px; 
			 margin-bottom: 5px; margin-left: 5px; margin-right: 5px;" 
			 border="0" /></p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="keyword">if</span>( bUseDesktop )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% other task can be performed on the same objects</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% last worker is the responsible of the visual correction.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ECG_all_wrappers(ii).this_pid == ECG_all_wrappers(ii).cant_pids)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if there are not any previous error.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ECG_all_wrappers(ii).Processed &amp;&amp; ~ECG_all_wrappers(ii).Error )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous saved results as starting point,</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any available</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cached_filenames = ECG_all_wrappers(ii).GetCahchedFileName( {<span class="string">'ECG_delineation_corrector'</span> <span class="string">'ECG_delineation'</span>} );
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if no previous correction work, try the automatic</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% detection task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any, do the correction</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ~isempty(cached_filenames) )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous saved results as starting point,</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if any available</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle = <span class="string">'ECG_delineation_corrector'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% This task is supposed to be supervised, so only one pid is enough.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).this_pid = <span class="string">'1/1'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% user provided name to individualize each run</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.user_string = user_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% to avoid loading cached results and exit, this flag</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% allows the re-editing of the current state of the</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% detections.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).cacheResults = false;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% maybe in your application you should run this for</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% all files.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.payload = load(cached_filenames{1});
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% process the task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).Run;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% restore the original pids configuration</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).this_pid = pid_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% As we changed for &quot;QRS correction&quot; task, we have to enable this</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% value again in order to avoid performing the following tasks every time.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% If you want to recalculate any task, change it to false</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).cacheResults = true;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% at the end, report problems if happened.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ReportErrors;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
	<h1 class="r2013b">Automatic Heartbeat classification<a name="Automatic_Heartbeat_classification"></a></h1>
	<p>The last task described in this example is the classification of 
	 heartbeats according to the <a href="matlab:web('http://marketplace.aami.org/eseries/scriptcontent/docs/Preview Files/EC57_1212_preview.pdf','-browser')">EC-57 
	 AAMI recommendation</a>. To achieve this task, the kit includes a 
	 <a href="../../../../../../jsD:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_heartbeat_classifier')">Heartbeat 
	 classification task</a> that interfaces with the <a href="','-browser')">Argentino-Aragonés 
	 heartbeat classifier (a2hbc)</a> project in order to classify heartbeats 
	 into the following classes:</p>
	<div>
		<ul>
			<li><b>N</b> normal</li>
			<li><b>S</b> supraventricular</li>
			<li><b>V</b> ventricular</li>
			<li><b>F</b> fusion of normal and ventricular</li>
		</ul>
	</div>
	<p>The <i>a2hbc</i> algorithm can opperate automatically or assisted 
	 by the user, for more details check the <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('a2hbc')">a2hbc 
	 documentation</a>.</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% this is to use previous cached results as starting point</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cached_filenames = ECG_all_wrappers(ii).GetCahchedFileName({<span class="string">'QRS_corrector'</span> <span class="string">'QRS_detection'</span>});
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% if corrected QRS detections are not available, wavedet</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% performs automatic QRS detection.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ~isempty(cached_filenames) )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle = <span class="string">'ECG_heartbeat_classifier'</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% the heartbeat classifier uses the QRS detection performed</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% before, if available the task will use the corrected</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% detections.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.payload = load(cached_filenames{1});
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% modes of operation of the a2hbc algorithm</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.mode = <span class="string">'auto'</span>;<span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.mode = 'slightly-assisted';</span><span class="comment">
% &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.mode = 'assisted';</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% user provided name to individualize each run</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ECGtaskHandle.user_string = user_str;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% process the task</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).Run;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="comment">% at the end, report problems if happened.</span>
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ECG_all_wrappers(ii).ReportErrors;
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
	<h1 class="r2013b">Visual inspection of the signal<a name="Visual_inspection_of_the_signal"></a></h1>
	<p>Finaly a report is generated with the results of the previous tasks, 
	 either in a pdf document or several images. The report generated can 
	 be customized with the interface described in the <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('reportECG')">documentation</a>. 
	 The following are just three examples of a longer report:</p>
	<p><img src="ex_ABP_PPG_Registro_01M_full_Pagina_01.png" alt="" style="margin-top: 5px; 
			 margin-bottom: 5px; margin-left: 5px; margin-right: 5px;" 
			 border="0" /></p>
	<p>A snapshot of the center</p>
	<p><img src="ex_ABP_PPG_Registro_01M_full_Pagina_05.png" alt="" style="margin-top: 5px; 
			 margin-bottom: 5px; margin-left: 5px; margin-right: 5px;" 
			 border="0" /></p>
	<p>And finaly a snapshot of the last part of the recording.</p>
	<p><img src="ex_ABP_PPG_Registro_01M_full_Pagina_10.png" alt="" style="margin-top: 5px; 
			 margin-bottom: 5px; margin-left: 5px; margin-right: 5px;" 
			 border="0" /></p>
	<p>This is the code used to create a PDF report.</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;filename = []; <span class="comment">% default setting. Let the report function decide.</span><span class="comment">
% &#160;&#160;&#160;&#160;filename = 'container_filename'; % to put everything in one big file.</span>
&#160;&#160;&#160;&#160;<span class="comment">% other winlengths can be added to the array in order to further</span>
&#160;&#160;&#160;&#160;<span class="comment">% explore the recordings, and the algorithm results.</span><span class="comment">
% &#160;&#160;&#160;&#160;winlengths = []; % default setting</span>
&#160;&#160;&#160;&#160;winlengths = [ 7 ]; <span class="comment">%seconds</span>
&#160;&#160;&#160;&#160;<span class="comment">% go through all files</span>
&#160;&#160;&#160;&#160;<span class="keyword">for</span> ii = 1:lrecnames
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ECG_all_wrappers(ii).this_pid == ECG_all_wrappers(ii).cant_pids)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="comment">% last worker is the responsible of the reporting.</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ECG_all_wrappers(ii).this_pid == ECG_all_wrappers(ii).cant_pids)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">try</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;reportECG(ECG_all_wrappers(ii), <span class="string">'LowDetail'</span>, <span class="string">'full'</span>, winlengths, <span class="string">'pdf'</span>, filename );
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">catch</span> MException
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;report = getReport(MException);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fprintf(2, <span class="string">'\n%s\n'</span>, report);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="keyword">end</span>
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
	<h1 class="r2013b">Other user-defined tasks ...<a name="Other_user-defined_tasks_"></a></h1>
	<p>Maybe the most important and useful aspect of the kit, is that you 
	 can add your own algorithms. This can be done by following the interface 
	 documented through the several examples included above. The <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_QRS_detection')">QRS 
	 detection</a> and <a href="../../../../../../:D:/Mariano/misc/ECGkit/help/robohelp/ECGkit/matlab:doc('ECGtask_ECG_delineation')">ECG 
	 delineation</a> tasks already include a way to interface your own 
	 algorithms through the <b>user:function_name</b> method. Check the 
	 above sections for more details.</p>
	<pre class="codeinput">
&#160;&#160;&#160;&#160;<span class="keyword">if</span>( ~bUseDesktop )
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;UnInstallECGkit();
&#160;&#160;&#160;&#160;<span class="keyword">end</span>
		</pre>
<!--content-->
</body>
</html>
